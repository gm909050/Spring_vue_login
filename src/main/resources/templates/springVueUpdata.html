<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>夢想假期會員更新頁面 - DreamHoliday</title>

<!-- <script
	src="<%=request.getContextPath()%>/https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/all.min.js"
	crossorigin="anonymous"></script>
<script
	src="<%=request.getContextPath()%>/https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script> -->
	<link rel="stylesheet" href="https://cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css">

    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
  crossorigin="anonymous"></script>


<style>
* {
	margin: 0;
	padding: 0;
}

div.card-header {
	background: linear-gradient(#2B3078, #0AA6B7);
	color: white;
}

div img.logo {
	width: 40%;
	margin: 0 auto;
	display: block;
}

main {
	margin: 50px auto;
}

div.card-footer {
	margin: 5px;
}

div.text-center {
	margin-top: 10px;
}

p.warn {
	color: red;
}

footer {
	background: linear-gradient(#0AA6B7, #2B3078);
	width: 100%;
	vertical-align: bottom;
	text-align: center;
}

footer #logo2 {
	width: 100vh;
	display: inline-block;
}

footer div p {
	display: inline-block;
	font-size: 20px;
	color: white;
	margin: 10px 10px;
	text-align: center;
}

footer div {
	max-width: 1000px;
	margin: 10px auto;
	text-align: center;
	position: relative;
}

footer div#sns {
	display: inline-block;
	position: relative;
}

footer img {
	display: inline-block;
	margin: 10px 10px;
	vertical-align: bottom;
}

footer img.sns {
	width: 50px;
	height: 50px;
}

footer img.twitter {
	width: 55px;
	height: 50px;
}

footer img.fb {
	width: 50px;
	height: 50px;
}

footer img.yt {
	width: 80px;
	height: 50px;
}

div.main.row {
	margin: 30px;
	width: 100%;
}

div.main div {
	margin: 20px;
}

div.main2 div {
	margin: 20px;
}

div div img.card {
	max-width: 500px;
}

div.main2 {
	display: none;
}
input#btn_yes{
    width:300px;
}
div.rounded-lg{
    height:500px;
}
.inputwight input{
    width:280px;
}
</style>
</head>
<body>

<div id="app">
	<div id="layoutAuthentication_content">
		<main>
			<div class="container">
				<div class="row justify-content-center">
					<div class="col-lg-7">
						<div class="card shadow-lg border-0 rounded-lg mt-5">
							<div class="card-header">
						
								
								</a>
								<h3 class="text-center font-weight-light my-4">夢想假期會員更新頁面</h3>
							
							</div>
	
            <div class="container"> 
                 <div class="row inputwight"> 
                     <div class="col-md-6"> 
                            <div class="col-md-6">
                                <div class="form-floating mb-3 mb-md-0">
                                    <input type="text" class="form-control UserId" id="inputFirstName" disabled="disabled" style="margin:5px;"  v-model.trim="userid" required
                                    placeholder="信箱">
                                    <label for="inputFirstName">會員ID</label>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="form-floating mb-3 mb-md-0">
                                    <input class="form-control UserName " id="inputFirstName" style="margin:5px;"
                                    
                                        type="text" name="name"	autofocus="off" v-model.trim="username" @keyup.enter="updatauser()" placeholder="姓名"							
                                         /> <label
                                        for="inputFirstName">會員姓名</label>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="form-floating mb-3 mb-md-0">
                                    <input class="form-control doublepassword" id="inputFirstName" style="margin:5px;"
                                    
                                        type="text" name="name"	v-model.number.trim="userage" @keyup.enter="updatauser()" placeholder="年紀"										
                                       /> <label
                                        for="inputFirstName">會員年紀</label>
                                </div>
                            </div>


										<div class="col-md-6">
											<div class="form-floating mb-3 mb-md-0">
												<input class="form-control Useremail" id="inputFirstName" style="margin:5px;"
												
													type="text" name="name"	disabled="disabled" v-model.trim="useremail" placeholder="姓名"									
													/> <label
													for="inputFirstName">會員帳號</label>
											</div>
										</div>
								
									<div class="col-md-6">
                                        <div class="form-floating mb-3 mb-md-0">
                                            <input class="Userpassword form-control" id="telNo" style="margin:5px;"  
                                            type="text"  v-model.trim="userpassword" @keyup.enter="updatauser()" placeholder="密碼"
                                             /> <label
                                            for="inputEmail">會員密碼</label>
                                        </div>
									</div>               
                            </div> 
                            <div class="col-md-6" >
                                <img style="width:300px;height: 300px; margin:10px auto;"  src="https://obs.line-scdn.net/0hUaYS4j8bCk5kKiNYQ4F1GV18Bj9XTh9IClJHIEgjAS4cSFFNXkVANEQvUHZVEx5KWVBCIBIuBHpBSBoeUBs"
                                >
                            </div>                 
                 </div>                 
             </div> 

									<div class="row justify-content-center">
										<!-- Button trigger modal -->
										<input type="hidden" name="action" value="insert"> 
										<input id="btn_yes" class="btn btn-primary updatauser" style="margin:5px;" type="submit" @click="updatauser()"  value="更新資料">
                                        <input id="btn_yes" class="btn btn-primary returnsheet" style="margin:5px;" type="submit" @click="reloadhome()"  value="返回">
								    </div>	
						</div>
						<div class="card-footer text-center py-3">
					
						</div>
					</div>
				</div>
			</div>
	</div>
	</main>
	</div>
</div>
    
    
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"
integrity="sha384-p34f1UUtsS3wqzfto5wAAmdvj+osOnFyQFpp4Ua3gs/ZVWx6oOypYoCJhGGScy+8"
crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.1.4/vue.global.min.js"></script>

<script
src="https://code.jquery.com/jquery-3.6.0.min.js"
integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
crossorigin="anonymous"></script>
<script>
       var updatauser = sessionStorage.getItem("updatauser");
       var tojson = JSON.parse(updatauser)
        Vue.createApp({
            
                data() {
                    return {
                        userid:"",
                        username :"",
                        userage : null,
                        useremail :"",
                        userpassword:"",
                        chinese:/^[\u4e00-\u9fa5]+$/,
                    }
                },
                
                methods: {
					getdata(){
               
                        if(tojson == null){
                            alert("沒登入 返回登入畫面")
                            location.href="springVueLogin.html"
                        }else{
                            console.log(tojson)
                             this.userid = tojson.id
                             this.username = tojson.name
                             this.userage = tojson.age
                             this.useremail = tojson.email
                             this.userpassword = tojson.password
                        } 

                    },
                    updatauser(){
                        var self = this;
                        if(this.username==""){
                            alert("會員姓名不能為空")
                        }else if(this.userage==""){
                            alert("會員年齡不能為空")
                        }else if(this.userpassword==""){
                            alert("會員密碼不能為空")
                        }else if(!this.chinese.test(this.username)){
                            alert("姓名格式需為中文")
                        }else if(this.userid == tojson.id && this.username==tojson.name && this.userage == tojson.age &&
                           this.useremail == tojson.email && this.userpassword == tojson.password){
                            alert("此次沒有更改資料")
                        }else{
                            let text = {
                                "id" : this.userid,
                                "name" : this.username,
                                "age" : this.userage,
                                "email" : this.useremail,
                                "password" : this.userpassword
                            };
                        

                            $.ajax({
                                    url: "http://localhost:8080/springbootusers/updata",           // 資料請求的網址
                                    type: "POST",                  // GET | POST | PUT | DELETE | PATCH
                                    data: text,               // 傳送資料到指定的 url
                                    dataType: "json",             // 預期會接收到回傳資料的格式： json | xml | html

                                    success: function(test){      // request 成功取得回應後執行  
                                            if(test == "更新成功"){
                                                alert("更新成功重新登入")
                                                sessionStorage.removeItem("updatauser");
						                        sessionStorage.removeItem("manageuser");
                                                location.href="springVueLogin.html"
                                            }else{
                                                alert("更新失敗請重新整理")
                                            }			
                                    }
                            });
                        }

                    },

                    reloadhome(){
                        location.href="springVueLogin.html"
                    }
                },
                computed:{
                        
                        
                },
                mounted(){
                    this.getdata();
        
                }      
        }).mount('#app');

</script>



</body>
</html>